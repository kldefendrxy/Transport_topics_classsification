# MODEL CARD — Transport Topics Classifier (Telegram)

## 1. Общая информация

**Название модели:** Transport Topics Classifier  
**Версия:** 1.0  
**Тип задачи:** Текстовая классификация (binary classification)  
**Назначение:** Определение, относится ли сообщение Telegram к тематике:
- «автотранспорт»
- «метрополитен»

Модель используется в составе MLOps-пайплайна для автоматического анализа публикаций транспортных Telegram-каналов.

---

## 2. Контекст и мотивация

Транспортные Telegram-каналы публикуют большое количество оперативной информации: ДТП, ремонтные работы, задержки метро, перекрытия, обновления маршрутов. Ручная сортировка сообщений затруднена, поэтому была поставлена задача:

> *Автоматически классифицировать сообщения по двум направлениям: автотранспорт и метро.*

Данная модель применяется в системах мониторинга, аналитики и обработки транспортных данных.

---

## 3. Данные

### Источники:
Публичные Telegram-каналы:

- Автотранспорт:
  - @DtRoad
  - @avtodorgk
  - @Mintrans_Russia

- Метро:
  - @mosmetro
  - @metro_spb
  - @metrostroi

### Объём:
- Всего: **~2600 сообщений**
- После очистки: **2636 строк**

### Предобработка включает:
- очистку ссылок, HTML-тегов
- удаление emoji
- удаление стоп-слов (NLTK)
- приведение к нижнему регистру
- лемматизацию (pymorphy3)
- удаление пунктуации
- нормализацию пробелов

Данные версионируются через **DVC**.  
Версии:
- `data/raw/` — v1 (сырые сообщения)
- `data/processed/` — v2 (очищенный датасет)

---

## 4. Архитектура модели

### Векторизация: **TF-IDF**

Параметры:
- ngram_range: (1, 2)
- max_features: 20 000
- min_df: 2

### Классификаторы:
Тестировались три baseline-модели:

1. **Logistic Regression**
2. **LinearSVC**
3. **Multinomial Naive Bayes**

### Финальная модель:
**LinearSVC** — выбрана как лучшая по F1-метрике.

---

## 5. Метрики качества

### Итоговые показатели

| Model              | Accuracy | Precision | Recall | F1    |
|--------------------|----------|-----------|--------|-------|
| LogisticRegression | 0.994    | 0.994     | 0.994  | 0.994 |
| NaiveBayes         | 0.985    | 0.982     | 0.986  | 0.984 |
| **LinearSVC**      | **0.996**| **0.995** | **0.996** | **0.996** |

### Оценка на тестовой выборке:
- Accuracy: **0.996**
- F1: **0.996**

Модель демонстрирует высокую стабильность и хорошую обобщающую способность.

---

## 6. Входная и выходная спецификация

### Вход:
JSON:

```json
{
  "text": "На Каширском шоссе произошло ДТП"
}
```

### Вход:
JSON:

```json
{
  "class": "автотранспорт",
  "probability": 0.92
}
```

## 7. Ограничения и риски

- Модель обучена на российских Telegram-каналах; перенос на другие регионы без переобучения снижает качество.
- Не распознаёт сарказм, скрытые смыслы, сложные контекстные конструкции.
- Чувствительна к ошибкам лемматизации (pymorphy3); возможны неправильные преобразования слов.
- Не определяет тональность и намерения, работает только как тематический классификатор.
- Предназначена только для текстов на русском языке.
- Не предназначена для прогнозирования, только для классификации.

## 8. Версионирование

Артефакты модели и данных управляются через связку Git + DVC.

### Версии данных:
- **v1** — `data/raw/` (сырые сообщения)
- **v2** — `data/processed/dataset.csv` (очищенный датасет)

### Версии модели:
Артефакты, отслеживаемые DVC:
- models/model.joblib
- models/vectorizer.joblib
- models/labels.joblib

### Управление версиями:
- Кодовая база: **Git**
- Данные и артефакты: **DVC**  
- Пайплайн: `dvc.yaml`, `dvc.lock`

Команда для воспроизведения пайплайна:

```bash
dvc repro
```

## 9. Использование в продакшене


Модель развёрнута как FastAPI-инференс-сервис.

### Эндпоинты:
- `GET /health` — проверка доступности сервиса
- `POST /predict` — классификация текста

### Пример использования:

```bash
curl -X POST "http://127.0.0.1:8000/predict" \
     -H "Content-Type: application/json" \
     -d "{\"text\":\"На Каширском шоссе произошло ДТП\"}"
```

### Развертывание через Docker:

Сборка контейнера:
```bash
docker build -t tg_classifier -f docker/Dockerfile .
```

Запуск контейнера:
```bash
docker run -p 8000:8000 tg_classifier
```

Документация доступна по адресу:
```
http://127.0.0.1:8000/docs
```

---

## 10. Авторы

- **Разработчик:** Фитц Артемий  
- **Проект:** Курсовая работа по дисциплине «Операционализация моделей машинного обучения (MLops)»  
- **Год:** 2025  